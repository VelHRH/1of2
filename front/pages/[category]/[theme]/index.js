import { useState } from "react";
import { NumberBtn } from "../../../components/NumberBtn";
import { BackBtn } from "../../../components/BackBtn";
import Link from "next/link";
import Head from "next/head";

export const getServerSideProps = async (context) => {
 const { category, theme } = context.params;
 const res = await fetch(
  `http://localhost:4444/categories/${category}/${theme}`
 );
 const data = await res.json();
 if (!data) {
  return {
   notFound: true,
  };
 }
 return {
  props: { theme: data[0] },
 };
};

const Theme = ({ theme }) => {
 const [clickedMode, setClickedMode] = useState("8");
 const handleModeChoice = (mode) => {
  setClickedMode(mode);
 };
 return (
  <div className="w-full flex">
   <Head>
    <title>{theme.name}</title>
    <meta name="description" content="Generated by create next app" />
    <link rel="icon" href="/favicon.ico" />
   </Head>
   <div className="flex-1 h-screen bg-slate-50 dark:bg-slate-800 p-10">
    <Link href={`/${theme.category}`}>
     <BackBtn>{theme.category}</BackBtn>
    </Link>
    <h1 className="text-4xl mb-7 dark:text-slate-50 capitalize">
     {theme.name}
    </h1>
    <div className="flex h-[350px]">
     <img
      src={theme.imgUrl}
      alt="Subcategory"
      className="flex-1 object-cover"
     />
     <div className="w-1/6">
      <div className="h-1/2 ml-10 mb-4 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-2xl shadow-[5px_5px] border-4 border-slate-800"></div>
      <div className="h-1/2 ml-10 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-2xl shadow-[5px_5px] border-4 border-slate-800"></div>
     </div>
    </div>
    <div className="grid gap-4 grid-cols-4 mt-10 w-full">
     <NumberBtn
      isClicked={clickedMode === "8"}
      handleModeChoice={handleModeChoice}
     >
      8
     </NumberBtn>
     <NumberBtn
      isClicked={clickedMode === "16"}
      handleModeChoice={handleModeChoice}
     >
      16
     </NumberBtn>
     <NumberBtn
      isClicked={clickedMode === "32"}
      handleModeChoice={handleModeChoice}
     >
      32
     </NumberBtn>
     <NumberBtn
      isClicked={clickedMode === "64"}
      handleModeChoice={handleModeChoice}
     >
      64
     </NumberBtn>
     <Link
      href={`/1of2/${theme.category}/${theme.name}/rating`}
      className="text-xl md:text-2xl flex justify-center py-2 dark:text-slate-900 text-slate-50 bg-gradient-to-r from-cyan-500 to-blue-600 cursor-pointer rounded-2xl hover:scale-110 ease-in-out duration-500 items-center"
     >
      Rating
     </Link>
     <div className="text-xl md:text-2xl flex justify-center py-2 dark:text-slate-900 text-slate-50 bg-gradient-to-r from-cyan-500 to-blue-600 cursor-pointer rounded-2xl hover:scale-110 ease-in-out duration-500 items-center">
      Share
     </div>
     <div
      onClick={() => setIsGame(true)}
      className="text-xl md:text-2xl col-span-2 flex justify-center py-2 dark:text-slate-900 text-slate-50 bg-gradient-to-r from-lime-500 to-green-600 cursor-pointer rounded-2xl hover:scale-105 ease-in-out duration-500"
     >
      Start
     </div>
    </div>
   </div>
   <div className="w-[25%] bg-slate-100 dark:bg-slate-900 min-h-screen"></div>
  </div>
 );
};

export default Theme;
